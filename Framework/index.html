<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="product" content="">
    <meta name="description"
          content="Популярный тренажер для экзамена HSK. И просто отличное приложение для изучения основной лексики 汉语.">
    <meta name="author" content="">

    <!--Metro UI-->
    <link href="css/metro-bootstrap.css" rel="stylesheet">
    <link href="css/iconFont.css" rel="stylesheet">
    <link href="css/tryhsk.css" rel="stylesheet">
    <script src="js/jquery/jquery-2.1.1.min.js"></script>
    <script src="js/jquery/jquery.widget.min.js"></script>
    <script src="//vk.com/js/api/xd_connection.js?2"  type="text/javascript"></script>
    <script>
        var vkid;
            VK.init(function () {    // инициализируем Vk API
                var parts = document.location.search.substr(1).split("&");
                var flashVars = {}, curr;
                for (i = 0; i < parts.length; i++) {
                    curr = parts[i].split('=');
                    flashVars[curr[0]] = curr[1];
                }
                vkid = flashVars['viewer_id'];

//                vkid = 1000000;
            });

    </script>
    <script src="js/metro.min.js"></script>
    <script src="js/docs.js"></script>
    <script src="js/underscore-min.js"></script>

    <!--AngularJS-->
    <script src="angular/angular.js"></script>
    <script src="angular/angular-locale_ru-ru.js"></script>
    <script src="angular-route/angular-route.js"></script>
    <script src="angular-resource/angular-resource.js"></script>
    <script src="src/ngCookies/cookies.js"></script>
    <script src="work/app.js"></script>
    <script src="work/controllers.js"></script>
    <script src="work/filters.js"></script>
    <script src="work/services.js"></script>

    <title>HSK. Китайский язык 汉语</title>


</head>
<body class="metro" ng-app="tryHsk" ng-cloak>
<div class="loader" ng-show="globalLoader">
    <div class="spinner">
    <div class="rect1"></div>
    <div class="rect2"></div>
    <div class="rect3"></div>
    <div class="rect4"></div>
    <div class="rect5"></div>
</div>
</div>
<!--дурацкий костыль от вспышек-->
<div id="f" style="height: 1000px; width: 500px;"></div>
    <div class="tab-control" data-role="tab-control" id="tab-control">
        <ul class="tabs">

            <li class="active"><a href="#_page_1">ТЕСТ</a></li>
            <li><a href="#_page_2">СЛОВАРЬ</a></li>
            <li class="place-right"><a href="#_page_5"><i class="icon-heart"></i></a></li>
            <li class="place-right"><a href="#_page_4"><i class="icon-cog"></i></a></li>
            <li class="place-right"><a href="#_page_3"><i class="icon-book"></i></a></li>
        </ul>

        <div class="frames">

            <div class="frame" id="_page_1">
                <div ng-include="'partials/test.html'"></div>
            </div>

            <div class="frame" id="_page_2">
                <div ng-include="'partials/summary.html'"></div>
            </div>

            <div class="frame" id="_page_3">
                <div ng-include="'partials/info.html'"></div>
            </div>

            <div class="frame" id="_page_4">
                <div ng-include="'partials/settings.html'"></div>
            </div>

            <div class="frame" id="_page_5">
                <div ng-include="'partials/love.html'"></div>
            </div>

            <div class="grid" style="margin-top:0;margin-bottom:0">
                <div class="row" style="margin-top:0;margin-bottom:0">
                    <div class="accordion" data-role="accordion" data-closeany="true">
                        <div class="accordion-frame">
                            <a class="active heading" href="#">Рейтинг пользователей</a>
                            <div class="content rating_content">
                                <div class="grid">
                                    <div class="row" style="margin: 0!important" ng-controller="ratingCtrl">
<div class="span1" ng-repeat="user in users.response" >
    {{user.first_name}}</br>
    {{user.last_name}}
    <img class="image" src="{{user.photo_medium}}">
</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

    </div>


</div>


<script type="text/javascript" charset="cp1251">

    setInterval(function() {
        var height = document.getElementById('tab-control').offsetHeight;
        console.log(height);
            VK.callMethod('resizeWindow',920,height);
    },100);






//    $(window).unload( function(){
//            var xhr = new XMLHttpRequest()
//            ,params = 'id=' +vkid+ '&amount=' + global_amount+ '&rights=' + global_rights;
//            xhr.open('GET', '/rating?'+params, true);
//            xhr.send(null);
//    } );
//window.onunload = function() {
//    var xhr = new XMLHttpRequest()
//            ,params = 'id=' +vkid+ '&amount=' + global_amount+ '&rights=' + global_rights;
//    xhr.open('GET', '/rating?'+params, true);
//    xhr.send(null);
//};



    //$(document).ready(function () {
    //    $('.toServer').click(function () {
    //            var xhr = new XMLHttpRequest();
    //            var id = 59379236;
    //            var amount = 1000;
    //            var rights = 500;
    //            var params = 'id=' + encodeURIComponent(id)+ '&amount=' + encodeURIComponent(amount)+ '&rights=' + encodeURIComponent(rights);
    //            alert(params);
    //            xhr.open('GET', '/vote?'+params, true);
    //
    //            xhr.onreadystatechange = function() {
    //                if (xhr.readyState != 4) return;
    //
    //                if (xhr.status != 200) {
    //                    // обработать ошибку
    //                    alert('Ошибка ' + xhr.status + ': ' + xhr.statusText);
    //                    return;
    //                }
    //                // обработать результат
    //                amount_global = JSON.parse(xhr.responseText);
    //                console.log('+++++++++++++++++');
    //                console.log(amount_global.amount);
    //                console.log(amount_global);
    //            };
    //            xhr.send(null);
    //        }
    //    );
    //});

</script>


</body>
</html>